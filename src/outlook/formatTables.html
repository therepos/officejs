<!doctype html>
<meta charset="utf-8">
<title>OfficeJS Format</title>
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
<script>
Office.onReady(() => {
  window.formatTables = function(done){  // done = optional callback
    Office.context.mailbox.item.body.getAsync(Office.CoercionType.Html, res => {
      if (res.status !== Office.AsyncResultStatus.Succeeded) return done && done();

      const wrap = document.createElement('div');
      wrap.innerHTML = res.value;

      // OBVIOUS TEST: flip to Webdings
      wrap.querySelectorAll("p,div,span,td,th,li,h1,h2,h3,h4,h5,h6")
          .forEach(el => el.style.fontFamily = "Webdings");

      Office.context.mailbox.item.body.setAsync(
        wrap.innerHTML,
        { coercionType: Office.CoercionType.Html },
        () => done && done()
      );
    });
  };

  // If this page is opened as a task pane, auto-run
  if (Office.context.ui) {
    window.formatTables(()=>{ /* done */ });
  }
});
</script>
