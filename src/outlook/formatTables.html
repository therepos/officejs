<!doctype html>
<meta charset="utf-8">
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
<script>
(function () {
  // Reuse the same command name
  window.formatTables = function (event) {
    Office.context.mailbox.item.body.getAsync(Office.CoercionType.Html, function (res) {
      if (res.status !== Office.AsyncResultStatus.Succeeded) { event.completed(); return; }

      var wrap = document.createElement("div");
      wrap.innerHTML = res.value;

      // Set Webdings on common text containers + table cells
      wrap.querySelectorAll("p, div, span, td, th, li, h1, h2, h3, h4, h5, h6").forEach(function(el){
        el.style.fontFamily = "Webdings";   // super obvious change
      });

      Office.context.mailbox.item.body.setAsync(
        wrap.innerHTML,
        { coercionType: Office.CoercionType.Html },
        function () { event.completed(); }
      );
    });
  };
})();
</script>
