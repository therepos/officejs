<!doctype html>
<meta charset="utf-8">
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
<script>
(function () {
  window.formatTables = function (event) {
    Office.context.mailbox.item.body.getAsync(Office.CoercionType.Html, function (res) {
      if (res.status !== Office.AsyncResultStatus.Succeeded) {
        event.completed(); return;
      }

      var wrapper = document.createElement("div");
      wrapper.innerHTML = res.value;

      var borderCss = "1pt solid #d9d9d9";
      var pad = "2px"; // 0.1in â‰ˆ 9.6px, use smaller so Outlook keeps it

      wrapper.querySelectorAll("table").forEach(function (t) {
        t.style.borderCollapse = "collapse";
        t.setAttribute("border", "1"); // extra hint for Outlook
        t.querySelectorAll("th, td").forEach(function (c) {
          c.style.border = borderCss;
          c.style.padding = pad;
        });
      });

      Office.context.mailbox.item.body.setAsync(
        wrapper.innerHTML,
        { coercionType: Office.CoercionType.Html },
        function () { event.completed(); }
      );
    });
  };
})();
</script>
