<!doctype html>
<meta charset="utf-8">
<title>OfficeJS Tools</title>
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
<body style="font:14px Segoe UI; padding:12px; line-height:1.4">
  <h3 style="margin:0 0 10px">OfficeJS Tools</h3>
  <button id="btnFormat"  style="margin:4px 0">Format tables (1pt grey, 0.1in)</button><br>
  <button id="btnWebdings" style="margin:4px 0">Set all text to Webdings (test)</button><br>
  <button id="btnReset"   style="margin:4px 0">Reset fonts to Segoe UI</button>
  <div id="status" style="margin-top:10px;color:#666"></div>

<script>
Office.onReady(() => {
  const status = (m)=>document.getElementById('status').textContent=m;

  function getHtml(){return new Promise(r=>{
    Office.context.mailbox.item.body.getAsync(Office.CoercionType.Html, x=>r(x.value||""));
  });}
  function setHtml(h){return new Promise(r=>{
    Office.context.mailbox.item.body.setAsync(h,{coercionType:Office.CoercionType.Html},()=>r());
  });}

  async function formatTables(){
    status("Formatting tables…");
    const html = await getHtml(), div=document.createElement('div'); div.innerHTML=html;
    const border='1pt solid #d9d9d9', pad='0.1in';
    div.querySelectorAll('table').forEach(t=>{
      t.style.borderCollapse='collapse';
      t.style.border=border;
      t.querySelectorAll('th,td').forEach(c=>{ c.style.border=border; c.style.padding=pad; });
    });
    await setHtml(div.innerHTML); status("Tables formatted ✓");
  }
  async function webdings(){
    status("Setting Webdings…");
    const html = await getHtml(), div=document.createElement('div'); div.innerHTML=html;
    div.querySelectorAll('p,div,span,td,th,li,h1,h2,h3,h4,h5,h6')
      .forEach(el=>el.style.fontFamily='Webdings');
    await setHtml(div.innerHTML); status("Webdings applied ✓");
  }
  async function resetFonts(){
    status("Resetting fonts…");
    const html = await getHtml(), div=document.createElement('div'); div.innerHTML=html;
    div.querySelectorAll('p,div,span,td,th,li,h1,h2,h3,h4,h5,h6')
      .forEach(el=>el.style.fontFamily='Segoe UI, Arial, sans-serif');
    await setHtml(div.innerHTML); status("Fonts reset ✓");
  }

  document.getElementById('btnFormat').onclick = formatTables;
  document.getElementById('btnWebdings').onclick = webdings;
  document.getElementById('btnReset').onclick = resetFonts;
});
</script>
</body>
